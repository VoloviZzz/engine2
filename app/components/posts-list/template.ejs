<!--<link rel="stylesheet" href="/css/cards-list.css">
<% if(user.adminMode) { %>
	<div class="mb-2">
		<span>Тип публикаций:</span>
		<select class="js-change-fragment-target select-text" data-fragment-id="<%= fragment.id -%>" name="target-post">
			<option value="">Не выбрано</option>
			<% for (let target of postTargets ) { %>
				<option value="<%= target.id -%>" <%= currentTarget == target.id ? "selected" : "" -%>><%= target.title -%></option>
			<% } %>
		</select>
	</div>
	<div class="mb-2">
		<span>Добавить URL для публикаций: <small>(например: /posts)</small></span>
		<input type="text" class="js-fragment-url-input input-text mb-2" value="<%= fragment.settings.url || "" -%>"  data-fragment-id="<%= fragment.id -%>" placeholder="URl...">
		<button class="btn js-fragment-set-url">Добавить</button>
	</div>
	<div class="mb-2">
		<% var disabledCatOptions = dynamicCategory ? 'disabled' : ''; %>
		<span>Категория для публикаций:</span>
		<select class="js-fragment-update-settings select-text mb-2" data-event="change" data-target="category" data-fragment-id="<%= fragment.id -%>">
			<option <%= disabledCatOptions -%> value="">Все категории</option>
			<% for (let category of postCategories ) { %>
				<option value="<%= category.id -%>" <%= currentCategory == category.id ? "selected" : "" -%> <%= disabledCatOptions -%>><%= category.title -%></option>
			<% } %>
		</select>
		<form id="js-post-cat-add" class="mb-2" data-target-id="<%= currentTarget -%>">
			<span>Добавить новую категорию:</span>
			<input name="catName" class="input-text mb-2" type="text" value="">
			<button class="btn">Добавить</button>
		</form>
	</div>
	<div>
		<span>Отображение даты публикации:</span>
		<% if(fragment.settings.showPublishedTime == '1') { %>
			<button class="btn js-fragment-update-settings" data-fragment-id="<%= fragment.id -%>" data-target="showPublishedTime" data-event="click" value="0">Скрыть</button>
		<% } else { %>
			<button class="btn js-fragment-update-settings" data-fragment-id="<%= fragment.id -%>" data-target="showPublishedTime" data-event="click" value="1">показать</button>
		<% } %>
	</div>
<% } %>
<div class="cards">
	<% if(user.adminMode) { %>
		<div class="admin-control-container cards-admin-control-container">
			<button class="btn cards-add js-posts-add" data-category="<%= currentCategory -%>" data-target="<%= currentTarget -%>">Добавить</button>
		</div>
	<% } %>
	<% if(posts.length < 1) { %>
		<h2>Публикации отсутствуют</h2>
	<% } %>
	<% posts.map(n => { %>
		<article class="cards__item">
            <% if(user.adminMode) { %>
                <div class="admin-control-container">
                    <button data-id="<%= n.id -%>" class="btn cards-delete js-post-delete">Удалить</button>
                    <% if(n.public) { %>
						<button data-id="<%= n.id -%>" data-value="0" class="btn cards-publicate js-post-togglePublication">Снять с публикации</button>
					<% } else { %>
						<button data-id="<%= n.id -%>" data-value="1" class="btn cards-publicate js-post-togglePublication">Публиковать</button>
					<% } %>
					<label class="btn cards-change-photo mt-2">
						<input type="file" class="js-post-upload-mainphoto" data-id="<%= n.id -%>" id="post-upload-mainphoto" style="display: none">
                    	<span>Изменить фото</span>
					</label>
                </div>
            <% } %>
            <div class="cards__img-wrapp">
                
				<% if (!n.video) { %>
					<a href="<%= fragment.settings.url -%>/<%= n.id -%>" class="cards__img-link">
						<img class="cards__img" src="<%= n.main_photo -%>" alt="<%=n.title%>">
					</a>
				<% }
				else { %>
					<%- n.video %>
				<% } %>
				
            </div>
            <div class="cards__title-wrap">
                <h2 class="cards__title">
					<% if(user.adminMode) { %>
						<input class="cards-title-edit js-post-update input-text" data-id="<%= n.id -%>" data-target="title" type="text" value="<%=n.title%>">
					<% } else { %>
						<a href="<%= fragment.settings.url -%>/<%= n.id -%>" class="cards__title-link">
							<span><%= n.title %></span>
						</a>
					<% } %>
                </h2>
            </div>
            <div class="cards__content-wrapp">
                <div class="cards__content">
					<p><%- Helpers.replaceLineBreaks(Helpers.trimByWords(n.text, 100)) -%></p>
					<a href="<%= fragment.settings.url -%>/<%= n.id -%>" class="btn cards__content-link text-center">Читать далее</a>
                </div>
            </div>
			<div class="cards-meta-wrapp">
				<div class="cards__content text-right">
					<% if(fragment.settings.showPublishedTime == '1') { %>
						<span>Опубликовано: <%= Helpers.formatDate(n.published, 'dd MMMM yyyy в hh:mm') -%></span>
					<% } %>
				</div>
			</div>
        </article>
	<% }) %>
</div>-->

<% if(user.adminMode) { %>
<div class="form-row">
	<div class="form-group col-md-6">
		<label>Тип публикации:</label>
		<select class="js-change-fragment-target form-control" data-fragment-id="<%= fragment.id -%>" name="target-post">
			<option value="">Не выбрано</option>
			<% for (let target of postTargets ) { %>
				<option value="<%= target.id -%>" <%= currentTarget == target.id ? "selected" : "" -%>><%= target.title -%></option>
			<% } %>
		</select>
	</div>
	<div class="form-group col-md-6">
		<label>Добавить URL для публикаций: <small>(например: /posts)</small></label>
		<input type="text" class="js-fragment-url-input form-control mb-2" value="<%= fragment.settings.url || "" -%>"  data-fragment-id="<%= fragment.id -%>" placeholder="URl...">
		<button class="btn js-fragment-set-url">Добавить</button>
	</div>
</div>

<div class="form-row">
	<% var disabledCatOptions = dynamicCategory ? 'disabled' : ''; %>
	<div class="form-group col-md-6">
		<label>Категория для публикаций:</label>
		<select class="js-fragment-update-settings form-control" data-event="change" data-target="category" data-fragment-id="<%= fragment.id -%>">
			<option <%= disabledCatOptions -%> value="">Все категории</option>
			<% for (let category of postCategories ) { %>
				<option value="<%= category.id -%>" <%= currentCategory == category.id ? "selected" : "" -%> <%= disabledCatOptions -%>><%= category.title -%></option>
			<% } %>
		</select>
	</div>
	<div class="form-group col-md-6">
		<form id="js-post-cat-add" data-target-id="<%= currentTarget -%>">
			<label>Добавить новую категорию:</label>
			<input name="catName" class="form-control mb-2" type="text" value="">
			<button class="btn">Добавить</button>
		</form>
	</div>
</div>

<div class="mb-2">
	<label>Отображение даты публикации:</label>
	<% if(fragment.settings.showPublishedTime == '1') { %>
		<button class="btn js-fragment-update-settings" data-fragment-id="<%= fragment.id -%>" data-target="showPublishedTime" data-event="click" value="0">Скрыть</button>
	<% } else { %>
		<button class="btn js-fragment-update-settings" data-fragment-id="<%= fragment.id -%>" data-target="showPublishedTime" data-event="click" value="1">Показать</button>
	<% } %>
</div>
<button class="btn js-posts-add mb-2" style="width: 100%" data-category="<%= currentCategory -%>" data-target="<%= currentTarget -%>">Добавить</button>
<% } %>
<% if(posts.length < 1) { %>
	<h2>Публикации отсутствуют</h2>
<% } %>

<div class="container-fluid">
	<div class="row d-inline-flex">
		<% posts.map(n => { %>
			<div class ="col-lg-4 col-md-12 p-2">
				<div class="card h-100">
					<div class="card-body">
						<% if(user.adminMode) { %>
							<button data-id="<%= n.id -%>" class="btn js-post-delete">Удалить</button>
							<% if(n.public) { %>
								<button data-id="<%= n.id -%>" data-value="0" class="btn js-post-togglePublication">Снять с публикации</button>
							<% } else { %>
							<button data-id="<%= n.id -%>" data-value="1" class="btn js-post-togglePublication">Публиковать</button>
						<% } %>
						<label class="btn mt-2">
							<input type="file" class="js-post-upload-mainphoto" data-id="<%= n.id -%>" id="post-upload-mainphoto" style="display: none">
							<span>Изменить фото</span>
						</label>
						<% } %>

						<% if (!n.video) { %>
							<a href="<%= fragment.settings.url -%>/<%= n.id -%>">
								<img class="card-img-top" src="<%= n.main_photo -%>" alt="<%=n.title%>">
							</a>
						<% }
						else { %>
							<%- n.video %>
						<% } %>

						<div style="font-weight: 500; text-align: left; font-size: 22px;">
							<% if(user.adminMode) { %>
								<input class="js-post-update" data-id="<%= n.id -%>" data-target="title" type="text" value="<%=n.title%>">
							<% } else { %>
							<a href="<%= fragment.settings.url -%>/<%= n.id -%>">
								<span><%= n.title %></span>
							</a>
							<% } %>
						</div>

						<p class="card-text"><%- Helpers.replaceLineBreaks(Helpers.trimByWords(n.text, 100)) -%></p>
						<a href="<%= fragment.settings.url -%>/<%= n.id -%>" class="btn text-center mb-3" style="width: 100%">Читать далее</a>

						<% if(fragment.settings.showPublishedTime == '1') { %>
							<p class="card-text text-right"><small class="text-muted">Опубликовано: <%= Helpers.formatDate(n.published, 'dd MMMM yyyy в hh:mm') -%></small></p>
						<% } %>
					</div>
				</div>
			</div>
		<% }) %>
	</div>
</div>

<%- pagination.render() -%>
<% if(user.adminMode) { %>
	<script src="/admins/js/posts-list.js" defer></script>
<% } %>