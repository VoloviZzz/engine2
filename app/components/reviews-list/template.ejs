
<link rel="stylesheet" href="/css/reviews-list.css">
<% if(user.adminMode) { %>

	<div class="form-row">
		<div class="form-group col-md-6">
			<label>Выберите категорию отзывов:</label>
			<select class="js-fragment-update-settings form-control" data-target="targetType" data-event="change" data-fragment-id="<%= fragment.id -%>" name="target-post">
				<option value="">Не выбрано</option>
				<% for (let target of reviewsCats ) { %>
					<% var targetSelected = target.title == fragment.settings.targetType ? `selected` : '' %>;
					<option value="<%= target.title -%>" <%= targetSelected -%> ><%= target.title -%></option>
				<% } %>
			</select>
		</div>
		<form id="js-add-reviews-category" class="form-group col-md-6">
			<div>
				<label>Или добавьте новую категорию:</label>
				<input type="text" class="form-control mb-2" aria-describedby="titleHelp">
				<button class="btn">Добавить</button>
			</div>
		</form>
	</div>

	<nav>
		<div class="nav nav-tabs" id="nav-tab" role="tablist">
		  <a class="nav-item nav-link active" id="nav-all-tab" data-toggle="tab" href="#nav-all" role="tab" aria-controls="nav-all" aria-selected="true">Все</a>
		  <a class="nav-item nav-link" id="nav-unpublished-tab" data-toggle="tab" href="#nav-unpublished" role="tab" aria-controls="nav-unpublished" aria-selected="false">Неопубликованные</a>
		</div>
	</nav>

<% } %>

	<div class="tab-content" id="nav-tabContent">
		<div class="tab-pane show active" id="nav-all" role="tabpanel" aria-labelledby="nav-all-tab">
			<%- include('./reviews-list') -%>
			<%- pagination.render() -%>
			<% if(user.id) { %>
				<div class="reviews-add-wrapper" id="js-reviews-add-wrapper" data-target-id="<%= targetId -%>" data-target-type="<%= fragment.settings.targetType -%>">
					<textarea class="select-text new-reviews-text" id="add-review-text" name="reviews-text"></textarea>
					<button class="btn new-reviews-button">Добавить</button>
				</div>
			<% } else { %>
				<div class="text-center">
					<h3>
						<b>Добавлять отзывы могут только зарегистрированные пользователи</b>
					</h3>
				</div>
			<% } %>
			<% if(user.adminMode) { %>
				<div class="tab-content not-modered-reviews">
					<%- include('./reviews-list', { reviews: reviewsNotPublished }) -%>
				</div>
			<% } %>
		</div>
		<div class="tab-pane" id="nav-unpublished" role="tabpanel" aria-labelledby="nav-unpublished-tab">
			<% if(user.adminMode) { %>
				<div class="tab-content not-modered-reviews">
					<%- include('./reviews-list', { reviews: reviewsNotPublished }) -%>
				</div>
			<% } %>
		</div>
	</div>

<script src="/js/reviews-list.js" defer></script>
<% if(user.adminMode) { %>
	<script src="/admins/js/reviews-list.js" defer></script>
<% } %>